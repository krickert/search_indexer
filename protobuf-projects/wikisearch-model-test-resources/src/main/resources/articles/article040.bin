
41284IP address spoofingÔ2In computer networking, IP address spoofing or IP spoofing is the creation of Internet Protocol (IP) packets with a false source IP address, for the purpose of impersonating another computing system.

Background

The basic protocol for sending data over the Internet network and many other computer networks is the Internet Protocol (IP). The protocol specifies that each IP packet must have a header which contains (among other things) the IP address of the sender of the packet. The source IP address is normally the address that the packet was sent from, but the sender's address in the header can be altered, so that to the recipient it appears that the packet came from another source. 

The protocol requires the receiving computer to send back a response to the source IP address so that spoofing is mainly used when the sender can anticipate the network response or does not care about the response.

The source IP address provides only limited information about the sender. It may provide general information on the region, city and town when on the packet was sent. It does not provide information on the identity of the sender or the computer being used.

Applications

IP address spoofing involving the use of a trusted IP address can be used by network intruders to overcome network security measures, such as authentication based on IP addresses. This type of attack is most effective where trust relationships exist between machines. For example, it is common on some corporate networks to have internal systems trust each other, so that users can log in without a username or password provided they are connecting from another machine on the internal network ‚Äì which would require them already being logged in. By spoofing a connection from a trusted machine, an attacker on the same network may be able to access the target machine without authentication.

IP address spoofing is most frequently used in denial-of-service attacks, where the objective is to flood the target with an overwhelming volume of traffic, and the attacker does not care about receiving responses to the attack packets. Packets with spoofed IP addresses are more difficult to filter since each spoofed packet appears to come from a different address, and they hide the true source of the attack. Denial of service attacks that use spoofing typically randomly choose addresses from the entire IP address space, though more sophisticated spoofing mechanisms might avoid non-routable addresses or unused portions of the IP address space. The proliferation of large botnets makes spoofing less important in denial of service attacks, but attackers typically have spoofing available as a tool, if they want to use it, so defenses against denial-of-service attacks that rely on the validity of the source IP address in attack packets might have trouble with spoofed packets. Backscatter, a technique used to observe denial-of-service attack activity in the Internet, relies on attackers' use of IP spoofing for its effectiveness.

Legitimate uses

The use of packets with a false source IP address is not always evidence of malicious intent. For example, in performance testing of websites, hundreds or even thousands of "vusers" (virtual users) may be created, each executing a test script against the website under test, in order to simulate what will happen when the system goes "live" and a large number of users log in simultaneously.

Since each user will normally have its own IP address, commercial testing products (such as HP LoadRunner, WebLOAD, and others) can use IP spoofing, allowing each user its own "return address" as well.

IP spoofing is also used in some server-side load balancing. It lets the load balancer spray incoming traffic, but not need to be in the return path from the servers to the client. This saves a networking hop through switches and the load balancer as well as outbound message processing load on the load balancer. Output usually has more packets and bytes, so the savings are significant. 

Services vulnerable to IP spoofing

Configuration and services that are vulnerable to IP spoofing:

* RPC (Remote procedure call services)
* Any service that uses IP address authentication

* The R services suite (rlogin, rsh, etc.)

Defense against spoofing attacks

Packet filtering is one defense against IP spoofing attacks. The gateway to a network usually performs ingress filtering, which is blocking of packets from outside the network with a source address inside the network. This prevents an outside attacker spoofing the address of an internal machine. Ideally, the gateway would also perform egress filtering on outgoing packets, which is blocking of packets from inside the network with a source address that is not inside. This prevents an attacker within the network performing filtering from launching IP spoofing attacks against external machines. An intrusion detection system (IDS) is a common use of packet filtering, which has been used to secure the environments for sharing data over network and host-based IDS approaches.

It is also recommended to design network protocols and services so that they do not rely on the source IP address for authentication.

Upper layers

Some upper layer protocols have their own defense against IP spoofing attacks. For example, Transmission Control Protocol (TCP) uses sequence numbers negotiated with the remote machine to ensure that arriving packets are part of an established connection. Since the attacker normally cannot see any reply packets, the sequence number must be guessed in order to hijack the connection. The poor implementation in many older operating systems and network devices, however, means that TCP sequence numbers can be predicted.

Other definitions 

The term spoofing is also sometimes used to refer to header forgery, the insertion of false or misleading information in e-mail or netnews headers. Falsified headers are used to mislead the recipient, or network applications, as to the origin of a message. This is a common technique of spammers and sporgers, who wish to conceal the origin of their messages to avoid being tracked.

See also

* Egress filtering
* Ingress filtering
* MAC Spoofing
* Network address translation
* Reverse-path forwarding
* Router (includes a list of manufacturers)
* Spoofed URL

References

External links

*[https://spoofer.caida.org/summary.php ANA Spoofer Project: State of IP Spoofing and Client Test]
* , Defending Against Sequence Number Attacks, February 2012"∂B{{Short description|Creating IP packets using a false IP address}}
{{refimprove|date=February 2012}}
[[File:IP spoofing en.svg|thumb|Example scenario of IP address spoofing]]
In [[computer networking]], '''IP address spoofing''' or '''IP spoofing''' is the creation of [[Internet Protocol]] (IP) [[Packet (information technology)|packets]] with a false source [[IP address]], for the purpose of impersonating another computing system.<ref>{{cite web |url=http://www.symantec.com/connect/articles/ip-spoofing-introduction |title=IP Spoofing: An Introduction |last=Tanase |first=Matthew |publisher=Symantec |date=March 10, 2003 |access-date=September 25, 2015}}</ref>

==Background==
The basic protocol for sending data over the Internet network and many other [[Computer network|computer networks]] is the [[Internet Protocol]] (IP). The protocol specifies that each IP packet must have a [[Header (computing)|header]] which contains (among other things) the IP address of the sender of the packet. The source IP address is normally the address that the packet was sent from, but the sender's address in the header can be altered, so that to the recipient it appears that the packet came from another source. 

The protocol requires the receiving computer to send back a response to the source IP address so that spoofing is mainly used when the sender can anticipate the network response or does not care about the response.

The source IP address provides only limited information about the sender. It may provide general information on the region, city and town when on the packet was sent. It does not provide information on the identity of the sender or the computer being used.

==Applications==
IP address spoofing involving the use of a trusted IP address can be used by network intruders to overcome network security measures, such as [[authentication]] based on IP addresses. This type of attack is most effective where trust relationships exist between machines. For example, it is common on some corporate networks to have internal systems trust each other, so that users can log in without a username or password provided they are connecting from another machine on the internal network ‚Äì which would require them already being logged in. By spoofing a connection from a trusted machine, an attacker on the same network may be able to access the target machine without authentication.

IP address spoofing is most frequently used in [[denial-of-service attack]]s,<ref name=":0">{{Cite journal |last1=Veeraraghavan |first1=Prakash |last2=Hanna |first2=Dalal |last3=Pardede |first3=Eric |date=2020-09-14 |title=NAT++: An Efficient Micro-NAT Architecture for Solving IP-Spoofing Attacks in a Corporate Network |journal=Electronics |language=en |volume=9 |issue=9 |pages=1510 |doi=10.3390/electronics9091510 |issn=2079-9292|doi-access=free }}</ref> where the objective is to flood the target with an overwhelming volume of traffic, and the attacker does not care about receiving responses to the attack packets. Packets with spoofed IP addresses are more difficult to filter since each spoofed packet appears to come from a different address, and they hide the true source of the attack. Denial of service attacks that use spoofing typically randomly choose addresses from the entire IP address space, though more sophisticated spoofing mechanisms might avoid non-routable addresses or unused portions of the IP address space. The proliferation of large [[botnet]]s makes spoofing less important in denial of service attacks, but attackers typically have spoofing available as a tool, if they want to use it, so defenses against denial-of-service attacks that rely on the validity of the source IP address in attack packets might have trouble with spoofed packets. [[Denial-of-service attack#Backscatter|Backscatter]], a technique used to observe denial-of-service attack activity in the Internet, relies on attackers' use of IP spoofing for its effectiveness.<ref>{{Cite book|title=GRIN - Today's Impact on Communication System by IP Spoofing and Its Detection and Prevention|url=https://www.grin.com/document/190620|access-date=2020-07-21|website=www.grin.com|language=en}}</ref>

==Legitimate uses==
The use of packets with a false source IP address is not always evidence of malicious intent. For example, in performance testing of websites, hundreds or even thousands of "vusers" (virtual users) may be created, each executing a test script against the website under test, in order to simulate what will happen when the system goes "live" and a large number of users log in simultaneously.

Since each user will normally have its own IP address, commercial testing products (such as [[HP LoadRunner]], [[WebLOAD]], and others) can use IP spoofing, allowing each user its own "return address" as well.

IP spoofing is also used in some server-side load balancing. It lets the load balancer spray incoming traffic, but not need to be in the return path from the servers to the client. This saves a networking hop through switches and the load balancer as well as outbound message processing load on the load balancer. Output usually has more packets and bytes, so the savings are significant. <ref>{{Cite web|url=https://www.ra.ethz.ch/cdstore/www7/1899/com1899.htm|title = Network Dispatcher: A Connection Router for Scalable Internet Services}}</ref>
<ref>{{Cite web|url=https://www.ibm.com/docs/en/was-nd/9.0.5?topic=use-dispatcher-component|title = Dispatcher component| website=[[IBM]] }}</ref>

==Services vulnerable to IP spoofing==
{{Unreferenced section|date=September 2016}}
Configuration and services that are vulnerable to IP spoofing:

* RPC ([[Remote Procedure Call|Remote procedure call]] services)
* Any service that uses IP address authentication
<!-- * The [[X Window System]]-->
* The R services suite ([[rlogin]], [[Remote Shell|rsh]], etc.)

==Defense against spoofing attacks==
[[Network layer firewall|Packet filtering]] is one defense against IP [[spoofing attack]]s. The gateway to a network usually performs [[ingress filtering]], which is blocking of packets from outside the network with a source address inside the network. This prevents an outside attacker spoofing the address of an internal machine. Ideally, the gateway would also perform [[egress filtering]] on outgoing packets, which is blocking of packets from inside the network with a source address that is not inside. This prevents an attacker within the network performing filtering from launching IP spoofing attacks against external machines. An [[intrusion detection system]] (IDS) is a common use of packet filtering, which has been used to secure the environments for sharing data over network and host-based IDS approaches.{{cn|date=December 2020}}

It is also recommended to design network protocols and services so that they do not rely on the source IP address for authentication.

===Upper layers===
Some [[upper layer protocol]]s have their own defense against IP spoofing attacks. For example, [[Transmission Control Protocol]] (TCP) uses sequence numbers negotiated with the remote machine to ensure that arriving packets are part of an established connection. Since the attacker normally cannot see any reply packets, the sequence number must be guessed in order to hijack the connection. The poor implementation in many older operating systems and network devices, however, means that TCP sequence numbers can be predicted.

== Other definitions ==
The term '''''spoofing''''' is also sometimes used to refer to ''header forgery'', the insertion of false or misleading information in [[e-mail spoofing|e-mail]] or [[netnews]] headers. Falsified headers are used to mislead the recipient, or network applications, as to the origin of a message. This is a common technique of [[spamming|spammers]] and [[sporgery|sporgers]], who wish to conceal the origin of their messages to avoid being tracked.

==See also==
* [[Egress filtering]]
* [[Ingress filtering]]
* [[MAC Spoofing]]
* [[Network address translation]]
* [[Reverse-path forwarding]]
* [[router (computing)|Router]] (includes a list of manufacturers)
* [[Spoofed URL]]

==References==
{{reflist}}

==External links==
*[https://spoofer.caida.org/summary.php ANA Spoofer Project: State of IP Spoofing and Client Test]
* {{IETF RFC|6528|link=no}}, Defending Against Sequence Number Attacks, February 2012

[[Category:Internet security]]
[[Category:Deception]]
[[Category:IP addresses|Spoofing]]
[[Category:Types of cyberattacks]]:2022-10-10T01:15:42ZB160367JZ
	Wikipedia'https://en.wikipedia.org/wiki/Main_PageMediaWiki 1.40.0-wmf.8"first-letterRb
%https://spoofer.caida.org/summary.php9ANA Spoofer Project: State of IP Spoofing and Client Testb»Ú´µ†Ù®¸jæ‰çö